(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6535],{47338:function(e,s,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/subscription",function(){return i(58619)}])},58619:function(e,s,i){"use strict";i.r(s);var t=i(85893),n=i(67294),a=i(33299),l=i(11163),r=i(41863),c=i(2859);let o=(0,i(48967).eI)("https://PROD_PROJECT_ID.supabase.co","PROD_SUPABASE_ANON_KEY_HERE"),d=(0,c.J)("pk_test_your_publishable_key"),u=[{id:"price_basic",name:"Basic",description:"Perfect for small repair shops",price:29.99,interval:"month",features:["Access to all basic parts","Standard shipping","Email support","10% discount on tools"]},{id:"price_pro",name:"Professional",description:"Ideal for growing businesses",price:79.99,interval:"month",features:["Access to all parts including premium","Priority shipping","Phone and email support","15% discount on tools","Early access to new products"],popular:!0},{id:"price_enterprise",name:"Enterprise",description:"For large repair operations",price:199.99,interval:"month",features:["Access to all parts including premium and exclusive","Free expedited shipping","Dedicated account manager","25% discount on tools","Early access to new products","Custom bulk pricing","API access"]}];s.default=function(){var e,s,i,c,p,h,m;let{data:x,status:g}=(0,a.useSession)(),b=(0,l.useRouter)(),[f,y]=(0,n.useState)(!0),[j,v]=(0,n.useState)(null),[N,w]=(0,n.useState)("month"),[_,k]=(0,n.useState)(!1),[S,P]=(0,n.useState)(!1);(0,n.useEffect)(()=>{"unauthenticated"===g&&b.push("/auth/signin?callbackUrl=/subscription")},[g,b]),(0,n.useEffect)(()=>{var e;async function s(){var e;if(null==x?void 0:null===(e=x.user)||void 0===e?void 0:e.id)try{let{data:e,error:s}=await o.from("subscriptions").select("*, prices(*, products(*))").eq("user_id",x.user.id).in("status",["trialing","active"]).single();if(s&&"PGRST116"!==s.code)throw s;v(e)}catch(e){console.error("Error fetching subscription:",e)}finally{y(!1)}}(null==x?void 0:null===(e=x.user)||void 0===e?void 0:e.id)?s():y(!1)},[x]);let E=async e=>{k(e);try{let s=await fetch("/api/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:e,quantity:1,metadata:{userId:x.user.id}})}),{sessionId:i}=await s.json(),t=await d,{error:n}=await t.redirectToCheckout({sessionId:i});if(n)throw n}catch(e){console.error("Error during checkout:",e),alert("An error occurred during checkout. Please try again.")}finally{k(!1)}},C=async()=>{P(!0);try{let e=await fetch("/api/create-portal-link",{method:"POST"}),{url:s}=await e.json();window.location.href=s}catch(e){console.error("Error creating portal link:",e),alert("An error occurred. Please try again.")}finally{P(!1)}};return"loading"===g||f?(0,t.jsx)(r.Z,{title:"Subscription Plans | MDTS",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("p",{className:"ml-4",children:"Loading subscription information..."})]})})}):"unauthenticated"===g?(0,t.jsx)(r.Z,{title:"Subscription Plans | MDTS",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{children:"Please sign in to view subscription plans."})})})}):(0,t.jsx)(r.Z,{title:"Subscription Plans | MDTS",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"MDTS Subscription Plans"}),(0,t.jsx)("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the perfect plan for your repair business. Unlock premium parts, priority shipping, and exclusive discounts."}),(0,t.jsx)("div",{className:"flex justify-center mt-8 mb-12",children:(0,t.jsxs)("div",{className:"bg-gray-100 p-1 rounded-full",children:[(0,t.jsx)("button",{onClick:()=>w("month"),className:"px-6 py-2 rounded-full ".concat("month"===N?"bg-white shadow-md":"text-gray-700"),children:"Monthly"}),(0,t.jsxs)("button",{onClick:()=>w("year"),className:"px-6 py-2 rounded-full ".concat("year"===N?"bg-white shadow-md":"text-gray-700"),children:["Yearly ",(0,t.jsx)("span",{className:"text-green-500 font-semibold",children:"-20%"})]})]})})]}),j?(0,t.jsxs)("div",{className:"max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-8 mb-12",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Your Current Subscription"}),(0,t.jsx)("span",{className:"px-4 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:"trialing"===j.status?"Trial":"Active"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-2",children:(null===(s=j.prices)||void 0===s?void 0:null===(e=s.products)||void 0===e?void 0:e.name)||"Subscription Plan"}),(0,t.jsx)("p",{className:"text-gray-600",children:(null===(c=j.prices)||void 0===c?void 0:null===(i=c.products)||void 0===i?void 0:i.description)||"Your active subscription plan"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-gray-600",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Billing Period:"})," ",(null===(p=j.prices)||void 0===p?void 0:p.interval_count)===1?"Monthly":"Yearly"]}),(0,t.jsxs)("p",{className:"text-gray-600",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Next billing date:"})," ",new Date(1e3*j.current_period_end).toLocaleDateString()]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["$",((null===(h=j.prices)||void 0===h?void 0:h.unit_amount)/100).toFixed(2),(0,t.jsxs)("span",{className:"text-sm text-gray-600 font-normal",children:["/",null===(m=j.prices)||void 0===m?void 0:m.interval]})]})})]}),(0,t.jsx)("button",{onClick:C,disabled:S,className:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition",children:S?"Loading...":"Manage Billing"})]}):(0,t.jsx)("div",{className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:u.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden ".concat(e.popular?"ring-2 ring-blue-500 transform scale-105":""),children:[e.popular&&(0,t.jsx)("div",{className:"bg-blue-500 text-white text-center py-2 font-semibold",children:"Most Popular"}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold mb-1",children:e.name}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("span",{className:"text-4xl font-bold",children:["$","month"===N?e.price:(.8*e.price*12).toFixed(2)]}),(0,t.jsxs)("span",{className:"text-gray-600",children:["/","month"===N?"month":"year"]})]}),(0,t.jsx)("button",{onClick:()=>E("month"===N?e.id:"".concat(e.id,"_yearly")),disabled:_===e.id,className:"w-full py-3 rounded-lg mb-6 ".concat(e.popular?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-100 text-gray-800 hover:bg-gray-200"," focus:outline-none focus:ring-2 focus:ring-blue-500 transition"),children:_===e.id?"Loading...":"Subscribe"}),(0,t.jsx)("ul",{className:"space-y-3",children:e.features.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("svg",{className:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),(0,t.jsx)("span",{children:e})]},s))})]})]},e.id))}),(0,t.jsxs)("div",{className:"max-w-3xl mx-auto mt-16",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Frequently Asked Questions"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"What's included in each plan?"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Each plan offers different levels of access to our parts catalog, shipping benefits, and support options. The higher-tier plans include additional perks like discounts on tools, early access to new products, and dedicated support."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Can I change my plan later?"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Yes, you can upgrade or downgrade your plan at any time. Changes will take effect at the start of your next billing cycle."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Is there a free trial?"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Yes, all plans come with a 14-day free trial. You can cancel anytime during the trial period and won't be charged."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"How do I cancel my subscription?"}),(0,t.jsx)("p",{className:"text-gray-600",children:'You can cancel your subscription at any time through the "Manage Billing" option. Your subscription will remain active until the end of your current billing period.'})]})]})]})]})})}}},function(e){e.O(0,[1216,1863,2888,179],function(){return e(e.s=47338)}),_N_E=e.O()}]);